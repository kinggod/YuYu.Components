!function(a){a.fn.exceltable=function(b){var c=a.extend({},a.fn.exceltable.defaults,b),d=a(this),e=a(this).children(c.excelTableSelector);if(a.browser.msie&&parseFloat(a.browser.version)<8||(e.css({width:"100%"}),e.attr({border:0,cellpadding:0,cellspacing:0})),e.css({borderCollapse:"separate",borderSpacing:0,tableLayout:"fixed",overflow:"hidden"}),c.horizontalResizable&&e.find("tr>*").css({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",wordBreak:"keep-all"}),a.browser.mozilla||a.safari||a.browser.msie&&parseFloat(a.browser.version)<8){var f=new Array,g=a.browser.mozilla?-3:0;a.each(a(e.find("tr").get(0)).children(),function(b,c){var d=a(c).innerWidth(),e=parseInt(a(c).css("padding-left")),h=parseInt(a(c).css("padding-right")),i=parseInt(a(c).css("border-left-width")),j=parseInt(a(c).css("border-right-width"));f[b]={width:d-e-h,paddingLeft:e,paddingRight:h,borderLeftWidth:i,borderRightWidth:j},g+=d+i+j}),e.css({display:"block",width:g}),a(e.children()).css({display:"block",overflow:"hidden"}),a.each(e.find("tr"),function(b,c){var d=a(a(c).children()).height(),e=parseInt(a(a(c).children()).css("padding-top")),g=parseInt(a(a(c).children()).css("padding-bottom"));a(c).css({display:"block",clear:"both"}),a.each(a(c).children(),function(b,c){var h=f[b],i=e+"px "+h.paddingRight+"px "+g+"px "+h.paddingLeft+"px";a(c).css({display:"block","float":"left",width:h.width-(a.browser.mozilla?1:0),height:d,margin:0,padding:i,borderLeftWidth:h.borderLeftWidth,borderRightWidth:h.borderRightWidth,overflow:"hidden"})})}),a.browser.msie&&"static"==d.css("position")&&d.css({position:"relative"})}if(c.storage)try{var h=a.parseJSON(c.storage.get(window.location.pathname));h&&(h.tableWidth&&e.width(h.tableWidth),a.each(e.find("tr"),function(b,d){a.each(a(d).children(),function(e,f){var g=a(f);if(c.verticalResizable&&h.rowHeights&&(g.attr("rowspan")||a(a(d).children()).height(h.rowHeights[b])),c.verticalResizable&&h.columnWidths){var i=h.columnWidths[e];("undefined"==i||i<c.minColumnWidth)&&(i=c.minColumnWidth),g.width(i)}})}))}catch(i){}if(a.each(e.find(c.fixedHorizontalSelector),function(b,c){var d=parseInt(a(c).css("z-index"));a(c).css({position:"relative",zIndex:(isNaN(d)?0:d)+1})}),a.each(e.find(c.fixedVerticalSelector),function(b,c){var d=parseInt(a(c).css("z-index"));a(c).css({position:"relative",zIndex:(isNaN(d)?0:d)+1})}),a.each(e.find(c.fixedAllSelector),function(b,c){var d=parseInt(a(c).css("z-index"));a(c).css({position:"relative",zIndex:(isNaN(d)?0:d)+1})}),a(d).scroll(function(){var b=a(d).scrollTop(),f=a(d).scrollLeft();e.find(c.fixedAllSelector).css({top:b,left:f}),e.find(c.fixedVerticalSelector).css({top:b}),e.find(c.fixedHorizontalSelector).css({left:f})}),c.horizontalResizable||c.verticalResizable){var j={resizable:null,parent:null,targetIndex:0,startX:0,startY:0,tableWidth:0,tableHeight:0,targetWidth:0,targetHeight:0},k={selectstart:function(){return!1},saveExcelTableData:function(){if(c.storage)try{var b={tableWidth:0,rowHeights:new Array,columnWidths:new Array};b.tableWidth=e.width(),a.each(e.find("tr"),function(c,d){a.each(a(d).children(),function(d,e){var f=a(e);f.attr("rowspan")||(b.rowHeights[c]=f.height()),0==c&&(b.columnWidths[d]=f.width())})});var d='{"tableWidth":'+b.tableWidth;c.verticalResizable&&(d+=',"rowHeights":['+b.rowHeights+"]"),c.horizontalResizable&&(d+=',"columnWidths":['+b.columnWidths+"]"),d+="}",c.storage.set(window.location.pathname,d)}catch(f){}},mousemove:function(b){var d=b||window.event;if("horizontal"==j.resizable){var f=d.screenX-j.startX;j.targetWidth+f<c.minColumnWidth&&(f=c.minColumnWidth-j.targetWidth),e.css({width:j.tableWidth+f+1}),a.each(e.find("tr"),function(b,c){a(a(c).children().get(j.targetIndex)).css({width:j.targetWidth+f})})}else if("vertical"==j.resizable){var g=d.screenY-j.startY;j.targetHeight+g<c.minRowHeight&&(g=c.minRowHeight-j.targetHeight),a(j.parent.children().get(j.targetIndex)).css({height:j.targetHeight+g}),a(a(j.parent.children().get(j.targetIndex)).children()).css({height:j.targetHeight+g})}},mouseup:function(){a(document.body).css("cursor","default"),a(document).unbind("selectstart",k.selectstart),a(document).unbind("mousemove",k.mousemove),a(document).unbind("mouseup",k.mouseup),j={resizable:null,parent:null,targetIndex:0,startX:0,startY:0,tableWidth:0,tableHeight:0,targetWidth:0,targetHeight:0},k.saveExcelTableData()}},l=a('<span data-id="resizehandler" data-resizable="horizontal"></span>').css(c.horizontalResizeHandlerStyle),m=a('<span data-id="resizehandler" data-resizable="vertical"></span>').css(c.verticalResizeHandlerStyle);a("[data-id=resizehandler]").live("mousedown",function(b){var c=b||window.event,d=a(this).parent();j.resizable=a(this).attr("data-resizable"),"horizontal"==j.resizable?j.targetIndex=d.index():"vertical"==j.resizable&&(j.parent=d.parent().parent(),j.targetIndex=d.parent().index()),j.startX=c.screenX,j.startY=c.screenY,j.tableWidth=e.width(),j.tableHeight=e.height(),j.targetWidth=d.width(),j.targetHeight=d.height(),a(document.body).css("cursor",a(this).css("cursor")),a(document).bind("selectstart",k.selectstart),a(document).bind("mousemove",k.mousemove),a(document).bind("mouseup",k.mouseup)}),a.each(e.find(c.allResizableSelector),function(b,d){a(d).css({position:"relative"}),c.horizontalResizable&&(a.browser.msie&&parseFloat(a.browser.version)<8&&l.css({height:a(d).innerHeight()-c.horizontalResizeHandlerStyle.top-c.horizontalResizeHandlerStyle.bottom}),a(d).append(l.clone())),c.verticalResizable&&a(d).append(m.clone())}),c.horizontalResizable&&a.each(e.find(c.horizontalResizableSelector),function(b,d){a(d).css({position:"relative"}),a.browser.msie&&parseFloat(a.browser.version)<8&&l.css({height:a(d).innerHeight()-c.horizontalResizeHandlerStyle.top-c.horizontalResizeHandlerStyle.bottom}),a(d).append(l.clone())}),c.verticalResizable&&a.each(e.find(c.verticalResizableSelector),function(b,c){a(c).css({position:"relative"}),a(c).append(m.clone())})}if(c.editable){var n=a('<input type="text"/>').css({margin:0,padding:0,backgroun:"none",backgroundColor:"transparent",border:"none 0"});e.find(c.editableSelector).dblclick(function(){var b=a(this);b.attr("data-editing")||(b.attr("data-editing",!0),n.val(b.text()),n.css({width:b.width(),height:b.height()}),n.bind("focusout",function(){var a=n.val();b.removeAttr("data-editing"),b.html(a),c.editComplete&&c.editComplete(a,b)}),n.bind("keydown",function(a){if(13==(a||window.event).keyCode){var d=n.val();b.removeAttr("data-editing"),b.html(d),c.editComplete&&c.editComplete(d,b)}}),b.html(""),b.append(n),n.focus())})}},a.fn.exceltable.defaults={storage:null,excelTableSelector:"[data-display=excel]",fixedAllSelector:"[data-fixed=all]",fixedVerticalSelector:"[data-fixed=vertical]",fixedHorizontalSelector:"[data-fixed=horizontal]",horizontalResizable:!1,horizontalResizableSelector:"[data-resizable=horizontal]",horizontalResizeHandlerStyle:{position:"absolute",top:0,right:0,bottom:0,width:4,height:"auto",fontSize:0,lineHeight:0,cursor:"ew-resize"},minColumnWidth:10,verticalResizable:!1,verticalResizableSelector:"[data-resizable=vertical]",verticalResizeHandlerStyle:{position:"absolute",right:0,bottom:0,left:0,width:"auto",height:4,fontSize:0,lineHeight:0,cursor:"ns-resize"},minRowHeight:0,allResizableSelector:"[data-resizable=all]",editable:!1,editableSelector:"[data-editable=true]",editComplete:function(){}}}(jQuery);